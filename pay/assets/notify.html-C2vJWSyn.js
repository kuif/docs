import{_ as s,c as a,a as t,o as e}from"./app-dNpwyf8p.js";const p={};function l(o,n){return e(),a("div",null,n[0]||(n[0]=[t(`<table><thead><tr><th style="text-align:center;">method</th><th style="text-align:center;">参数</th><th style="text-align:center;">返回值</th></tr></thead><tbody><tr><td style="text-align:center;">notify</td><td style="text-align:center;">无/array/ServerRequestInterface</td><td style="text-align:center;">Collection</td></tr></tbody></table><h2 id="支付回调" tabindex="-1"><a class="header-anchor" href="#支付回调"><span>支付回调</span></a></h2><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token variable">$pay</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>fengkui<span class="token punctuation">\\</span>Pay<span class="token punctuation">\\</span>Wechat</span><span class="token punctuation">(</span><span class="token variable">$wechatConfig</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 支付回调</span></span>
<span class="line"><span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$pay</span><span class="token operator">-&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 验签并获取支付回调相关参数</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 支付成功</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token variable">$pay</span><span class="token operator">-&gt;</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 异步通知</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$e</span><span class="token operator">-&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 错误信息</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// 当回调数据为空时，请打印错误信息</span></span>
<span class="line"><span class="token comment">// $pay-&gt;notify(false); 不验证签名，直接返回支付信息</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="通知参数" tabindex="-1"><a class="header-anchor" href="#通知参数"><span>通知参数</span></a></h2><p>相关通知参数说明，请参考<a href="https://pay.weixin.qq.com/wiki/doc/apiv3/apis/chapter3_1_5.shtml" target="_blank" rel="noopener noreferrer">这里</a>，查看「通知参数」一栏。</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;mchid&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;appid&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;out_trade_no&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;order_snxxxxxxxx&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;transaction_id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;transaction_idxxxxxxxx&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;trade_type&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;JSAPI&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;trade_state&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;SUCCESS&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;trade_state_desc&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;支付成功&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;bank_type&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;OTHERS&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;attach&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;success_time&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;2022-04-30T18:47:25+08:00&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;payer&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string double-quoted-string">&quot;openid&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;openidxxxxxxxx&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;amount&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string double-quoted-string">&quot;total&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string double-quoted-string">&quot;payer_total&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string double-quoted-string">&quot;currency&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;CNY&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string double-quoted-string">&quot;payer_currency&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;CNY&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="确认回调" tabindex="-1"><a class="header-anchor" href="#确认回调"><span>确认回调</span></a></h2><p>通知微信端，支付完成，收到通知参数</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token variable">$pay</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>fengkui<span class="token punctuation">\\</span>Pay<span class="token punctuation">\\</span>Wechat</span><span class="token punctuation">(</span><span class="token variable">$wechatConfig</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">return</span> <span class="token variable">$pay</span><span class="token operator">-&gt;</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 确认回调</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9)]))}const c=s(p,[["render",l],["__file","notify.html.vue"]]),u=JSON.parse('{"path":"/wechat/notify.html","title":"接收回调","lang":"zh-CN","frontmatter":{"title":"接收回调"},"headers":[{"level":2,"title":"支付回调","slug":"支付回调","link":"#支付回调","children":[]},{"level":2,"title":"通知参数","slug":"通知参数","link":"#通知参数","children":[]},{"level":2,"title":"确认回调","slug":"确认回调","link":"#确认回调","children":[]}],"git":{"updatedTime":1712041033000,"contributors":[{"name":"kuifeng","email":"1161634940@qq.com","commits":1}]},"filePathRelative":"wechat/notify.md"}');export{c as comp,u as data};
